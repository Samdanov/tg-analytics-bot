def build_analysis_prompt(description: str, posts_text: str) -> str:
    return f"""Ты — эксперт по анализу Telegram-каналов. Твоя задача: точно определить целевую аудиторию и ключевые темы канала на основе предоставленных данных.

**ВХОДНЫЕ ДАННЫЕ:**

Описание канала:
\"\"\"
{description}
\"\"\"

Последние посты:
\"\"\"
{posts_text}
\"\"\"

**ЗАДАЧА:**

1. **Целевая аудитория** — определи максимально конкретно:
   • Основные сегменты (возраст, пол, профессия/роль)
   • Ключевые интересы и боли аудитории
   • Зачем они подписаны (образование, развлечение, новости, бизнес)
   • Уровень экспертности (новички, специалисты, профи)
   
2. **Ключевые слова** (10-20 штук) — для поиска похожих каналов:
   • Основные темы и ниши (технологии, маркетинг, здоровье и т.п.)
   • Специфичные термины из постов (названия продуктов, технологий, методик)
   • НЕ включай общие слова (новости, канал, пост, подписка)
   • НЕ включай стоп-слова и предлоги
   • Приоритет: узкие специфичные термины > широкие категории

3. **Тональность** — кратко опиши стиль подачи:
   • Формальный/неформальный, экспертный/развлекательный
   • Эмоциональная окраска (мотивирующий, ироничный, нейтральный)

**ПРАВИЛА (обязательны!):**
✓ Используй ТОЛЬКО информацию из описания и постов
✓ Если данных мало — пиши "по косвенным признакам", "вероятно"
✓ Ключевые слова — в единственном числе, именительном падеже
✓ НЕ придумывай факты, которых нет в текстах
✓ НЕ используй внешние знания о канале
✓ Ответ СТРОГО в формате JSON

**ПРИМЕРЫ ХОРОШИХ КЛЮЧЕВЫХ СЛОВ:**
• Для IT-канала: "python", "kubernetes", "backend", "микросервисы", "devops"
• Для бизнес-канала: "стартап", "венчур", "метрика", "продажи", "b2b"
• Для маркетинга: "таргет", "креатив", "conversion", "smm", "контент"

**ФОРМАТ ОТВЕТА:**
{{
  "audience": "Конкретное описание ЦА: кто они, зачем читают, какой уровень. Примеры: 'IT-специалисты 25-40 лет, изучающие backend-разработку' или 'Предприниматели и основатели стартапов, ищущие кейсы роста'",
  "tone": "Стиль и тон канала. Примеры: 'Экспертный, с техническими деталями' или 'Неформальный, с мемами и иронией'",
  "keywords": ["слово1", "слово2", "слово3", ...]
}}

Отвечай ТОЛЬКО JSON, без дополнительного текста."""
