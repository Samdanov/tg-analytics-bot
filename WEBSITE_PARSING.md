# Парсинг и анализ веб-сайтов

## Описание

Бот "ОРБИТА" теперь поддерживает анализ веб-сайтов аналогично анализу Telegram каналов. При отправке ссылки на сайт бот:

1. Парсит содержимое сайта
2. Очищает HTML от мусора (реклама, навигация, футеры)
3. Извлекает основной текстовый контент
4. Уменьшает количество токенов (суммаризация)
5. Анализирует через LLM (ключевые слова, целевая аудитория)
6. Находит похожие Telegram каналы по ключевым словам
7. Генерирует Excel отчет

## Использование

### Отправка ссылки на сайт

Просто отправьте боту ссылку на сайт, например:
- `https://example.com`
- `www.example.com`
- `example.com`

Бот автоматически определит, что это сайт (не Telegram канал) и предложит выбрать количество похожих каналов для анализа.

### Процесс анализа

1. **Парсинг сайта** - загрузка и очистка HTML
2. **Извлечение текста** - удаление рекламы, навигации, футеров
3. **Суммаризация** - уменьшение количества токенов до 8000 символов
4. **LLM анализ** - определение ключевых слов и целевой аудитории
5. **Поиск похожих каналов** - поиск в базе каналов по ключевым словам
6. **Генерация отчета** - создание Excel файла с похожими каналами

## Технические детали

### Очистка HTML

Удаляются следующие элементы:
- `<script>`, `<style>` - скрипты и стили
- `<nav>`, `<header>`, `<footer>`, `<aside>` - навигация и боковые панели
- Элементы с классами/ID содержащими: `ad`, `advertisement`, `banner`, `cookie`, `popup`, `modal`, `menu`, `navigation`, `sidebar`, `comment`, `social`, `share`

### Уменьшение токенов

- Удаление повторяющихся фраз
- Фильтрация коротких предложений (< 20 символов)
- Удаление предложений только из цифр и символов
- Ограничение длины до 8000 символов

### Поиск похожих каналов

Используется упрощенный алгоритм TF-IDF:
- Нормализация ключевых слов
- Вычисление пересечения ключевых слов
- Score на основе количества совпадений
- Фильтрация шумовых каналов

## Файлы

- `app/services/website_parser/parser.py` - Парсер сайтов
- `app/services/usecases/website_service.py` - Сервис анализа сайтов
- `app/services/similarity_engine/website_similarity.py` - Поиск похожих каналов
- `app/services/llm/analyzer.py` - Функция `analyze_text_content()` для анализа текста
- `app/bot/handlers/workflow.py` - Обработчики для сайтов

## Зависимости

- `aiohttp` - для асинхронных HTTP запросов
- `beautifulsoup4` - для парсинга HTML

## Ограничения

- Таймаут загрузки: 10 секунд
- Максимальная длина текста: 8000 символов
- Минимальное количество совпадений ключевых слов: 2
