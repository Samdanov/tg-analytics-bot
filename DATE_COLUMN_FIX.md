# Исправление столбца "Дата создания" в Excel отчетах

## Проблема
В Excel отчетах был столбец "Дата создания", который показывал дату создания записи в БД (когда был выполнен анализ), а не дату создания канала в Telegram.

**Причина:** В базе данных нет информации о дате создания канала в Telegram. Telegram API может предоставить эту информацию, но она не сохранялась.

## Решение
Столбец "Дата создания" заменен на **"№"** (порядковый номер) - простая нумерация каналов от 1 до N.

## Внесенные изменения

### 1. `app/services/xlsx_generator.py`
- ✅ Заголовок "Дата создания" → "№"
- ✅ Удалена логика получения даты из БД (`created_at`, `created_str`)
- ✅ Добавлен счетчик `row_number` для нумерации
- ✅ В каждой строке первая колонка теперь содержит порядковый номер (1, 2, 3, ...)
- ✅ Обновлено выравнивание для первой колонки (центр)

### 2. `app/services/use_cases/website_service.py`
- ✅ Заголовок "Дата создания" → "№"
- ✅ Удалена логика получения даты (`created_str`)
- ✅ Добавлен счетчик `row_number` для нумерации
- ✅ В каждой строке первая колонка теперь содержит порядковый номер
- ✅ Обновлены комментарии в коде

## Структура таблицы Excel (до и после)

### До:
| Дата создания | Релевантность, % | Ссылка на канал | Подписчики | Название канала | Описание канала |
|---------------|------------------|-----------------|------------|-----------------|-----------------|
| 21.12.2025    | 85.3             | https://...     | 10000      | Канал 1         | Описание        |
| 21.12.2025    | 75.1             | https://...     | 5000       | Канал 2         | Описание        |

### После:
| № | Степень схожести | Ссылка на канал | Подписчики | Название канала | Описание канала |
|---|------------------|-----------------|------------|-----------------|-----------------|
| 1 | Очень высокая    | https://...     | 10000      | Канал 1         | Описание        |
| 2 | Высокая          | https://...     | 5000       | Канал 2         | Описание        |

## Преимущества нового формата

1. **Удобная навигация** - легко ссылаться на каналы по номеру ("посмотри канал №5")
2. **Нет путаницы** - больше нет бессмысленной даты анализа
3. **Сортировка** - номера показывают порядок по релевантности (1 = самый похожий)
4. **Простота** - никакой лишней информации

## Возможное улучшение в будущем

Если понадобится реальная дата создания канала:

1. **Добавить поле в БД:**
   ```python
   # app/db/models.py
   class Channel(Base):
       # ...
       created_date = Column(TIMESTAMP, nullable=True)  # Дата создания канала в Telegram
   ```

2. **Получать дату при парсинге:**
   ```python
   # app/services/telegram_parser/channel_info.py
   # Telegram API предоставляет channel.date (дата создания)
   ```

3. **Сохранять в БД:**
   ```python
   channel_create = ChannelCreateSchema(
       # ...
       created_date=channel_data.get("date")  # Из Telegram API
   )
   ```

4. **Добавить в отчет:**
   ```python
   # Вернуть столбец "Дата создания" с реальной датой из Telegram
   ```

## Тестирование

✅ Синтаксис проверен
✅ Оба файла (`xlsx_generator.py`, `website_service.py`) обновлены
✅ Готово к использованию

Теперь при генерации отчетов первый столбец будет показывать порядковый номер канала (1, 2, 3, ...) вместо даты.
